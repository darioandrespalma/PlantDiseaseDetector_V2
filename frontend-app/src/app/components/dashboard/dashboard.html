<mat-toolbar class="toolbar" color="primary">
  <h1>Plant Disease Detector</h1>
  <span class="toolbar-spacer"></span>
  <button mat-icon-button (click)="logout()" matTooltip="Cerrar Sesión">
    <mat-icon>logout</mat-icon>
  </button>
</mat-toolbar>

<div class="container">
  <mat-card class="upload-card">
    <mat-card-header>
      <mat-card-title>Analizar nuevo cultivo</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <label for="file-upload" class="file-upload-label" [class.loading]="isLoading">
        <mat-icon>cloud_upload</mat-icon>
        <span>{{ selectedFileName || 'Seleccionar una imagen' }}</span>
      </label>
      <input id="file-upload" type="file" (change)="onFileSelected($event)" accept="image/*">

      <button mat-raised-button color="primary" (click)="onUpload()" [disabled]="isLoading || !selectedFile">
        {{ isLoading ? 'Analizando...' : 'Analizar' }}
      </button>

      <mat-progress-bar *ngIf="isLoading" mode="indeterminate"></mat-progress-bar>

    </mat-card-content>
  </mat-card>

  <mat-card class="result-card" *ngIf="predictionResult">
    <mat-card-header>
      <mat-card-title>Resultado del Análisis</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <h3>Enfermedad Detectada: {{ predictionResult.result.disease }}</h3>
      <p><strong>Confianza:</strong> {{ (predictionResult.result.confidence * 100).toFixed(2) }}%</p>
      <p><strong>Recomendaciones:</strong></p>
      <pre>{{ predictionResult.result.recommendations }}</pre>
    </mat-card-content>
  </mat-card>
</div>