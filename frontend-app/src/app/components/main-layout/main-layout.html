<mat-sidenav-container class="sidenav-container" autosize>

  <!-- Sidenav izquierdo -->
  <mat-sidenav 
    #snav 
    class="main-sidenav"
    [mode]="mobileQuery.matches ? 'over' : 'side'"
    [fixedInViewport]="mobileQuery.matches"
    fixedTopGap="0"
    [opened]="!mobileQuery.matches"
    [class.sidenav-collapsed]="isSidenavCollapsed"
    @sidenavAnimation>
    
    <!-- Header con gradiente -->
    <div class="sidenav-header">
      <mat-icon class="logo-icon">agriculture</mat-icon>
      <div class="header-info" *ngIf="!isSidenavCollapsed">
        <span class="logo-text">PD-IA v2</span>
        <small class="logo-subtitle">Asistente Agrícola</small>
      </div>
    </div>


    <!-- Menú principal -->
    <mat-nav-list class="nav-list">
      <a 
        mat-list-item 
        *ngFor="let item of menuItems"
        [routerLink]="item.route" 
        routerLinkActive="active-item"
        [class.active-item]="isActive(item.route)"
        [matTooltip]="isSidenavCollapsed ? item.name : ''"
        matTooltipPosition="right"
        class="nav-item">
        
        <mat-icon matListItemIcon class="nav-icon">{{ item.icon }}</mat-icon>
        <span *ngIf="!isSidenavCollapsed" class="nav-text">{{ item.name }}</span>
        
        <!-- Indicador activo -->
        <div class="active-indicator" *ngIf="isActive(item.route)"></div>
      </a>
    </mat-nav-list>

    <!-- Footer del menú -->
    <div class="sidenav-footer" *ngIf="!isSidenavCollapsed">
      <div class="user-card">
        <mat-icon class="user-icon">person</mat-icon>
        <div class="user-details">
          <strong class="user-name">{{ userName }}</strong>
          <small class="user-role">Productor Agrícola</small>
        </div>
      </div>
      
      <div class="footer-actions">
        <button 
          mat-icon-button 
          class="theme-toggle-btn"
          (click)="theme.toggle()"
          matTooltip="Cambiar tema">
          <mat-icon>{{ theme.isDark() ? 'dark_mode' : 'light_mode' }}</mat-icon>
        </button>
        

      </div>
    </div>

  </mat-sidenav>

  <!-- Contenido principal -->
  <mat-sidenav-content class="main-content">
    
    <!-- Toolbar superior -->
    <mat-toolbar color="primary" class="main-toolbar">
      <button 
        mat-icon-button 
        class="menu-toggle"
        (click)="toggleSidenav()"
        matTooltip="Menú">
        <mat-icon>menu</mat-icon>
      </button>
      
      <span class="toolbar-title">Detector de Enfermedades</span>
      
      <span class="toolbar-spacer"></span>
      
      <!-- Indicador de ruta actual -->
      <div class="route-indicator" *ngIf="!mobileQuery.matches">
        <mat-icon class="indicator-icon">location_on</mat-icon>
        <span class="indicator-text">{{ currentRoute | titlecase }}</span>
      </div>
      
      <!-- Acciones rápidas -->
      <button 
        mat-icon-button 
        class="theme-toggle"
        (click)="theme.toggle()"
        matTooltip="Cambiar tema">
        <mat-icon>{{ theme.isDark() ? 'dark_mode' : 'light_mode' }}</mat-icon>
      </button>
      
      <button 
        mat-icon-button 
        class="logout-btn"
        (click)="logout()"
        matTooltip="Cerrar Sesión">
        <mat-icon>logout</mat-icon>
      </button>
    </mat-toolbar>

    <!-- Contenido de la página -->
    <div class="content-wrapper">
      <router-outlet></router-outlet>
    </div>

  </mat-sidenav-content>

</mat-sidenav-container>